const fs = require('fs');

// 第13章XML文件第38行的SVG base64数据
const base64Svg = "PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MDAiIGhlaWdodD0iNjAwIj4KICA8ZGVmcz4KICAgIDxzdHlsZT4KICAgICAgLm5vZGUgeyBmaWxsOiAjZjBmMGYwOyBzdHJva2U6ICMzMzM7IHN0cm9rZS13aWR0aDogMnB4OyB9CiAgICAgIC5lZGdlIHsgc3Ryb2tlOiAjMzMzOyBzdHJva2Utd2lkdGg6IDJweDsgfQogICAgICAubGFiZWwgeyBmb250LWZhbWlseTogQXJpYWwsIHNhbnMtc2VyaWY7IGZvbnQtc2l6ZTogMTRweDsgfQogICAgPC9zdHlsZT4KICA8L2RlZnM+CiAgPGcgY2xhc3M9ImxhYmVsIj4KICAgIDxyZWN0IGNsYXNzPSJub2RlIiB4PSIzMDAiIHk9IjUwIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjYwIiByeD0iNSIvPgogICAgPHRleHQgeD0iNDAwIiB5PSI4NSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgc3R5bGU9ImZvbnQtd2VpZ2h0OiBib2xkOyI+c3RkLnRlc3Rpbmc8YnIvPuWfuueBueWkhOeQhuWwgemfsTwvdGV4dD4KICAgIAogICAgPHJlY3QgY2xhc3M9Im5vZGUiIHg9IjEwMCIgeT0iMTUwIiB3aWR0aD0iMTUwIiBoZWlnaHQ9IjYwIiByeD0iNSIvPgogICAgPHRleHQgeD0iMTc1IiB5PSIxODUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPmV4cGVjdCgpPC90ZXh0PgogICAgPHJlY3QgY2xhc3M9Im5vZGUiIHg9IjEwMCIgeT0iMjUwIiB3aWR0aD0iMTUwIiBoZWlnaHQ9IjYwIiByeD0iNSIvPgogICAgPHRleHQgeD0iMTc1IiB5PSIyODUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPmV4cGVjdEVxdWFsKCk8L3RleHQ+CiAgICA8cmVjdCBjbGFzcz0ibm9kZSIgeD0iMTAwIiB5PSIzNTAiIHdpZHRoPSIxNTAiIGhlaWdodD0iNjAiIHJ4PSI1Ii8+CiAgICA8dGV4dCBgeD0iMTc1IiB5PSIzODUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPmV4cGVjdEVycm9yKCk8L3RleHQ+CiAgICA8cmVjdCBjbGFzcz0ibm9kZSIgeD0iMTAwIiB5PSI0NTAiIHdpZHRoPSIxNTAiIGhlaWdodD0iNjAiIHJ4PSI1Ii8+CiAgICA8dGV4dCB4PSIxNzUiIHk9IjQ4NSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+ZXhwZWN0RXF1YWxTbGljZXMoKTwvdGV4dD4KICAgIDxyZWN0IGNsYXNzPSJub2RlIiB4PSIxMDAiIHk9IjU1MCIgd2lkdGg9IjE1MCIgaGVpZ2h0PSI2MCIgcng9IjUiLz4KICAgIDx0ZXh0IHg9IjE3NSIgeT0iNTg1IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5leHBlY3RFcXVhbFN0cmluZ3MoKTwvdGV4dD4KICAgIAogICAgPHJlY3QgY2xhc3M9Im5vZGUiIHg9IjMwMCIgeT0iMTUwIiB3aWR0aD0iMTUwIiBoZWlnaHQ9IjYwIiByeD0iNSIvPgogICAgPHRleHQgeD0iMzc1IiB5PSIxODUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPmFsbG9jYXRvcjwvdGV4dD4KICAgIDxyZWN0IGNsYXNzPSJub2RlIiB4PSIzMDAiIHk9IjI1MCIgd2lkdGg9IjE1MCIgaGVpZ2h0PSI2MCIgcng9IjUiLz4KICAgIDx0ZXh0IHg9IjM3NSIgeT0iMjg1IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5mYWlsaW5nX2FsbG9jYXRvcjwvdGV4dD4KICAgIAogICAgPHJlY3QgY2xhc3M9Im5vZGUiIHg9IjUwMCIgeT0iMTUwIiB3aWR0aD0iMTUwIiBoZWlnaHQ9IjYwIiByeD0iNSIvPgogICAgPHRleHQgeD0iNTc1IiB5PSIxODUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPnJhbmRvbV9zZWVkPC90ZXh0PgogICAgPHJlY3QgY2xhc3M9Im5vZGUiIHg9IjUwMCIgeT0iMjUwIiB3aWR0aD0iMTUwIiBoZWlnaHQ9IjYwIiByeD0iNSIvPgogICAgPHRleHQgeD0iNTc1IiB5PSIyODUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPnRtcERpcigpPC90ZXh0PgogICAgPHJlY3QgY2xhc3M9Im5vZGUiIHg9IjUwMCIgeT0iMzUwIiB3aWR0aD0iMTUwIiBoZWlnaHQ9IjYwIiByeD0iNSIvPgogICAgPHRleHQgeD0iNTc1IiB5PSIzODUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPmxvZ19sZXZlbDwvdGV4dD4KICAgIAogICAgPGxpbmUgY2xhc3M9ImVkZ2UiIHgxPSIzMDAiIHkxPSIxMTAiIHgyPSIxNzUiIHkyPSIxNTAiLz4KICAgIDxsaW5lIGNsYXNzPSJlZGdlIiB4MT0iMzAwIiB5MT0iMTEwIiB4Mj0iMzc1IiB5Mj0iMTUwIi8+CiAgICA8bGluZSBjbGFzcz0iZWRnZSIgeDE9IjMwMCIgeTE9IjExMCIgeDI9IjU3NSIgeTI9IjE1MCIvPgogICAgPGxpbmUgY2xhc3M9ImVkZ2UiIHgxPSIzMDAiIHkxPSIxMTAiIHgyPSIzNzUiIHkyPSIxNTAiLz4KICAgIDxsaW5lIGNsYXNzPSJlZGdlIiB4MT0iMzAwIiIHkxPSIxMTAiIHgyPSI1NzUiIHkyPSIxNTAiLz4KICAgIDxsaW5lIGNsYXNzPSJlZGdlIiB4MT0iMzAwIiB5MT0iMTEwIiB4Mj0iNTc1IiB5Mj0iMTUwIi8+CiAgPC9nPgo8L3N2Zz4K";

// 解码base64
const svgContent = Buffer.from(base64Svg, 'base64').toString('utf8');

console.log('SVG内容:');
console.log(svgContent);

// 检查是否有损坏字符
console.log('\n检查损坏字符:');
for (let i = 0; i < svgContent.length; i++) {
    const char = svgContent[i];
    if (char.charCodeAt(0) > 127 && !/^[\u4e00-\u9fa5]$/.test(char)) {
        console.log(`位置 ${i}: '${char}' (ASCII: ${char.charCodeAt(0)})`);
    }
}

// 检查XML有效性
console.log('\n检查XML闭合标签:');
const lines = svgContent.split('\n');
lines.forEach((line, index) => {
    if (line.includes('</') && !line.includes('</svg>')) {
        console.log(`第${index + 1}行: ${line.trim()}`);
    }
});